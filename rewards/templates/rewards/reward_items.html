{% extends "shared/layout.html" %} {% block "content" %}

<div class="max-w-5xl mx-auto bg-white shadow-md rounded-lg p-6">
  <h1 class="text-2xl font-bold mb-4">新增及附加商品</h1>

  <!-- 已存在的商品與選項 -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
    <!-- 左側：已存在的商品 -->
    <div>
      <h2 class="text-xl font-semibold mb-4">已存在的商品</h2>
      <ul class="space-y-2">
        {% for product in products %}
        <li class="p-4 border rounded-md bg-gray-50 flex justify-between items-center">
          <span class="text-gray-700 font-medium">{{ product.name }}</span>
        </li>
        {% empty %}
        <p class="text-gray-500">目前沒有商品</p>
        {% endfor %}
      </ul>
    </div>
  
    <!-- 右側：已存在的附加選項 -->
    <div>
      <h2 class="text-xl font-semibold mb-4">已存在的附加選項</h2>
      <ul class="space-y-2">
        {% for option in options %}
        <li class="p-4 border rounded-md bg-gray-50 flex justify-between items-center">
          <span class="text-gray-700 font-medium">{{ option.name }}</span>
          <span class="text-gray-500">NTD {{ option.price }}</span>
        </li>
        {% empty %}
        <p class="text-gray-500">目前沒有附加選項</p>
        {% endfor %}
      </ul>
    </div>
  </div>

  <div x-data="formHandler()" class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <!-- 左側：Products Form -->
    <form method="POST" class="border p-4 rounded-md">
      {% csrf_token %}
      <h2 class="text-xl font-semibold mb-4">商品</h2>
      <div class="space-y-4">
        <template x-for="(product, index) in products" :key="index">
          <div class="flex items-center space-x-4 p-4 border rounded-md">
            <div class="flex-grow">
              <label class="block text-sm font-medium text-gray-700">商品名稱</label>
              <input
                type="text"
                x-model="product.name"
                :name="'products[' + index + ']'"
                class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"
              />
            </div>
            <button type="button" @click="removeProduct(index)" class="self-end py-2 px-3 text-red-500 hover:text-red-700">刪除</button>
          </div>
        </template>

        <button type="button" @click="addProduct" class="w-full py-2 px-4 bg-blue-500 text-white rounded-md hover:bg-blue-600">新增商品</button>
      </div>

      <div class="flex justify-between mt-6">
        <button type="reset" @click="resetForm" class="py-2 px-4 bg-gray-300 rounded-md hover:bg-gray-400">Reset</button>
        <button name="save_products" type="submit" class="py-2 px-4 bg-indigo-500 text-white rounded-md hover:bg-indigo-600">Save</button>
      </div>
    </form>
    <form method="POST" class="border p-4 rounded-md">
      {% csrf_token %}
      <h2 class="text-xl font-semibold mb-4">選項</h2>
      <div class="space-y-4">
        <template x-for="(option, index) in options" :key="index">
          <div class="flex items-center space-x-4 p-4 border rounded-md">
            <div class="flex-grow grid grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700">選項名稱</label>
                <input
                  type="text"
                  x-model="option.name"
                  :name="'options[' + index + '][name]'"
                  class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"
                />
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">價格</label>
                <input
                  type="number"
                  x-model="option.price"
                  :name="'options[' + index + '][price]'"
                  class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"
                />
              </div>
            </div>
            <button type="button" @click="removeOption(index)" class="self-end py-2 px-3 text-red-500 hover:text-red-700">刪除</button>
          </div>
        </template>

        <button type="button" @click="addOption" class="w-full py-2 px-4 bg-blue-500 text-white rounded-md hover:bg-blue-600">新增選項</button>
      </div>

      <div class="flex justify-between mt-6">
        <button type="reset" @click="resetOptions" class="py-2 px-4 bg-gray-300 rounded-md hover:bg-gray-400">Reset</button>
        <button name="save_options" type="submit" class="py-2 px-4 bg-indigo-500 text-white rounded-md hover:bg-indigo-600">Save</button>
      </div>
    </form>
  </div>
</div>
<div class="flex justify-between mt-6">
  <a href="{% url 'projects:rewards_index' project.slug %}" class="py-2 px-4 bg-gray-300 rounded-md hover:bg-gray-400">回 reward</a>
</div>


{% endblock %}
